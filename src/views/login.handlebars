<div class="card login-card">
  <h1>Login de Administrador</h1>
  <p>Solo el administrador puede agregar y eliminar productos.</p>
  
  <form id="login-form" class="login-form">
    <div class="mb-10">
      <label for="username">Usuario:</label><br/>
      <input type="text" id="username" required class="w-100" />
      <small>Usuario: <strong>coder</strong></small>
    </div>
    
    <div class="mb-10">
      <label for="password">Contraseña:</label><br/>
      <input type="password" id="password" required class="w-100" />
      <small>Contraseña: <strong>coder</strong></small>
    </div>
    
    <button type="submit" class="btn btn-primary w-100">
      Iniciar Sesión
    </button>
  </form>
  
  <div id="message" class="mt-15"></div>
</div>

<script>
  const form = document.getElementById('login-form');
  const message = document.getElementById('message');
  
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    
    try {
      const response = await fetch('/api/auth/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ username, password })
      });
      
      const data = await response.json();
      
      if (data.success) {
        // Guardar sessionId en localStorage
        localStorage.setItem('sessionId', data.sessionId);
          message.className = 'mt-15 text-success';
          message.textContent = '✅ Login exitoso! Redirigiendo...';
        
        setTimeout(() => {
          window.location.href = '/realtimeproducts';
        }, 1000);
      } else {
          message.className = 'mt-15 text-danger';
          message.textContent = '❌ ' + data.message;
      }
    } catch (error) {
        message.className = 'mt-15 text-danger';
        message.textContent = '❌ Error al intentar login';
    }
  });
</script>
